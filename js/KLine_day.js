var chartDom = document.getElementById('day');
var myChart = echarts.init(chartDom);
var option;

var upColor = '#ec0000';
var upBorderColor = '#8A0000';
var downColor = '#00da3c';
var downBorderColor = '#008F28';
// Each item: open，close，lowest，highest
const mydata2 = [['2023-05-29', 12.13, 12.02, 11.76, 12.25],
 ['2023-05-30', 12.09, 11.91, 11.75, 12.18],
 ['2023-05-31', 11.87, 11.75, 11.7, 11.98],
 ['2023-06-01', 11.77, 11.97, 11.7, 12.16],
 ['2023-06-02', 12.13, 12.35, 12.0, 12.52],
 ['2023-06-05', 12.48, 12.47, 12.37, 12.68],
 ['2023-06-06', 12.43, 12.12, 12.09, 12.62],
 ['2023-06-07', 12.22, 11.98, 11.92, 12.25],
 ['2023-06-08', 11.92, 12.31, 11.92, 12.36],
 ['2023-06-09', 12.33, 12.85, 12.33, 12.96],
 ['2023-06-12', 12.7, 12.92, 12.44, 13.09],
 ['2023-06-13', 13.0, 12.66, 12.56, 13.19],
 ['2023-06-14', 12.56, 12.58, 12.32, 12.75],
 ['2023-06-15', 12.64, 12.67, 12.44, 13.01],
 ['2023-06-16', 12.68, 12.5, 12.48, 12.83],
 ['2023-06-19', 12.5, 12.48, 12.24, 12.65],
 ['2023-06-20', 12.51, 12.47, 12.28, 12.66],
 ['2023-06-21', 12.44, 12.44, 12.32, 12.95],
 ['2023-06-26', 12.33, 12.06, 12.01, 12.88],
 ['2023-06-27', 12.09, 12.42, 12.01, 12.61],
 ['2023-06-28', 12.3, 12.36, 12.15, 12.66],
 ['2023-06-29', 12.36, 12.46, 12.21, 12.75],
 ['2023-06-30', 12.5, 13.23, 12.37, 13.33],
 ['2023-07-03', 13.23, 13.99, 13.23, 14.44],
 ['2023-07-04', 13.97, 13.9, 13.7, 14.23],
 ['2023-07-05', 13.85, 13.65, 13.6, 14.2],
 ['2023-07-06', 13.59, 13.79, 13.43, 14.25],
 ['2023-07-07', 13.67, 13.61, 13.55, 14.29],
 ['2023-07-10', 13.47, 13.36, 13.29, 13.67],
 ['2023-07-11', 13.43, 14.68, 13.41, 15.15],
 ['2023-07-12', 14.73, 14.29, 14.21, 14.97],
 ['2023-07-13', 14.21, 13.84, 13.6, 14.39],
 ['2023-07-14', 13.81, 13.7, 13.59, 14.04],
 ['2023-07-17', 13.6, 13.73, 13.21, 13.85],
 ['2023-07-18', 13.75, 13.92, 13.55, 14.16],
 ['2023-07-19', 13.86, 13.93, 13.8, 14.25],
 ['2023-07-20', 13.85, 13.44, 13.41, 14.08],
 ['2023-07-21', 13.38, 13.35, 13.28, 13.74],
 ['2023-07-24', 13.04, 12.89, 12.84, 13.12],
 ['2023-07-25', 13.1, 13.79, 13.03, 13.82],
 ['2023-07-26', 13.76, 13.43, 13.17, 13.84],
 ['2023-07-27', 13.58, 13.21, 13.15, 13.95],
 ['2023-07-28', 13.14, 13.51, 12.93, 13.75],
 ['2023-07-31', 14.34, 14.39, 13.91, 15.19],
 ['2023-08-01', 14.29, 14.4, 13.98, 14.67],
 ['2023-08-02', 14.21, 14.42, 14.15, 14.76],
 ['2023-08-03', 14.35, 14.12, 13.82, 14.37],
 ['2023-08-04', 13.98, 13.68, 13.6, 14.23],
 ['2023-08-07', 13.68, 13.87, 13.59, 14.02],
 ['2023-08-08', 13.92, 13.62, 13.55, 13.94],
 ['2023-08-09', 13.53, 13.77, 13.4, 13.82],
 ['2023-08-10', 13.68, 13.28, 13.22, 13.7],
 ['2023-08-11', 13.42, 12.94, 12.9, 13.47],
 ['2023-08-14', 12.8, 12.85, 12.6, 12.91],
 ['2023-08-15', 12.89, 12.64, 12.5, 13.03],
 ['2023-08-16', 12.5, 12.57, 12.44, 12.75],
 ['2023-08-17', 12.48, 12.96, 12.41, 12.99],
 ['2023-08-18', 12.88, 12.9, 12.88, 13.19],
 ['2023-08-21', 12.91, 12.79, 12.78, 13.06],
 ['2023-08-22', 12.79, 12.85, 12.58, 12.98],
 ['2023-08-23', 12.85, 12.71, 12.67, 12.95],
 ['2023-08-24', 12.79, 11.66, 11.57, 12.8],
 ['2023-08-25', 11.66, 11.24, 10.93, 11.66],
 ['2023-08-28', 11.81, 11.54, 11.47, 11.92],
 ['2023-08-29', 11.31, 12.02, 11.29, 12.07],
 ['2023-08-30', 12.02, 11.96, 11.82, 12.16],
 ['2023-08-31', 11.93, 11.81, 11.8, 12.0],
 ['2023-09-01', 11.81, 12.28, 11.81, 12.35],
 ['2023-09-04', 12.28, 12.91, 12.26, 12.94],
 ['2023-09-05', 12.84, 12.73, 12.64, 12.91],
 ['2023-09-06', 12.64, 12.78, 12.61, 12.88],
 ['2023-09-07', 12.64, 12.27, 12.22, 12.79],
 ['2023-09-08', 12.27, 12.4, 12.23, 12.52],
 ['2023-09-11', 12.38, 12.6, 12.2, 12.78],
 ['2023-09-12', 12.65, 12.43, 12.37, 12.69],
 ['2023-09-13', 12.47, 12.26, 12.18, 12.48],
 ['2023-09-14', 12.27, 12.17, 12.08, 12.39],
 ['2023-09-15', 12.18, 12.08, 12.02, 12.28],
 ['2023-09-18', 11.97, 12.26, 11.95, 12.41],
 ['2023-09-19', 12.25, 12.19, 12.1, 12.32],
 ['2023-09-20', 12.12, 12.0, 11.99, 12.23],
 ['2023-09-21', 11.96, 11.83, 11.76, 12.06],
 ['2023-09-22', 11.89, 12.02, 11.79, 12.05],
 ['2023-09-25', 12.0, 12.0, 11.85, 12.17],
 ['2023-09-26', 12.0, 12.07, 11.96, 12.18],
 ['2023-09-27', 12.08, 11.86, 11.85, 12.12],
 ['2023-09-28', 11.9, 12.1, 11.88, 12.23],
 ['2023-10-09', 12.19, 12.17, 11.95, 12.29],
 ['2023-10-10', 12.18, 11.77, 11.64, 12.18],
 ['2023-10-11', 11.8, 11.67, 11.65, 11.86],
 ['2023-10-12', 11.75, 11.84, 11.72, 12.04],
 ['2023-10-13', 11.69, 11.02, 10.9, 11.69],
 ['2023-10-16', 11.0, 10.95, 10.88, 11.1],
 ['2023-10-17', 10.92, 10.89, 10.74, 10.96],
 ['2023-10-18', 10.84, 10.9, 10.8, 11.4],
 ['2023-10-19', 10.85, 10.63, 10.62, 10.87],
 ['2023-10-20', 10.59, 10.57, 10.51, 10.84],
 ['2023-10-23', 10.59, 10.49, 10.43, 10.67],
 ['2023-10-24', 10.51, 10.45, 10.37, 10.58],
 ['2023-10-25', 10.6, 10.66, 10.55, 10.89],
 ['2023-10-26', 10.59, 10.68, 10.17, 10.68],
 ['2023-10-27', 10.65, 10.71, 10.55, 11.0],
 ['2023-10-30', 10.65, 10.37, 10.12, 10.66],
 ['2023-10-31', 10.32, 10.13, 10.06, 10.42],
 ['2023-11-01', 10.13, 10.06, 10.05, 10.21],
 ['2023-11-02', 10.06, 10.02, 10.02, 10.21],
 ['2023-11-03', 10.07, 10.22, 10.0, 10.32],
 ['2023-11-06', 10.23, 10.33, 10.23, 10.38],
 ['2023-11-07', 10.26, 10.33, 10.26, 10.47],
 ['2023-11-08', 10.28, 10.21, 10.16, 10.31],
 ['2023-11-09', 10.18, 10.35, 10.12, 10.43],
 ['2023-11-10', 10.29, 10.17, 10.04, 10.3],
 ['2023-11-13', 10.2, 10.39, 10.18, 10.39],
 ['2023-11-14', 10.4, 10.52, 10.35, 10.54],
 ['2023-11-15', 10.59, 10.59, 10.49, 10.76],
 ['2023-11-16', 10.53, 10.26, 10.24, 10.57],
 ['2023-11-17', 10.25, 10.37, 10.2, 10.41],
 ['2023-11-20', 10.39, 10.41, 10.29, 10.48],
 ['2023-11-21', 10.44, 10.32, 10.31, 10.52],
 ['2023-11-22', 10.26, 10.08, 10.08, 10.3],
 ['2023-11-23', 10.08, 10.5, 10.06, 10.52],
 ['2023-11-24', 10.47, 10.22, 10.2, 10.48],
 ['2023-11-27', 10.28, 10.27, 10.12, 10.45],
 ['2023-11-29', 10.79, 10.91, 10.55, 11.2],
 ['2023-11-30', 10.72, 11.11, 10.66, 11.46],
 ['2023-12-01', 11.01, 10.71, 10.66, 11.06],
 ['2023-12-04', 10.7, 10.4, 10.34, 10.71],
 ['2023-12-05', 10.31, 10.15, 10.15, 10.35],
 ['2023-12-06', 10.09, 10.09, 10.06, 10.23],
 ['2023-12-07', 10.06, 9.96, 9.84, 10.08],
 ['2023-12-08', 9.95, 9.7, 9.61, 9.99],
 ['2023-12-11', 9.68, 9.75, 9.58, 9.77],
 ['2023-12-12', 9.72, 9.77, 9.67, 9.79],
 ['2023-12-13', 9.77, 9.52, 9.52, 9.77],
 ['2023-12-14', 9.56, 9.43, 9.42, 9.62],
 ['2023-12-15', 9.46, 9.48, 9.39, 9.75],
 ['2023-12-18', 9.32, 9.48, 9.31, 9.76],
 ['2023-12-19', 9.46, 9.37, 9.29, 9.51],
 ['2023-12-20', 9.35, 9.17, 9.17, 9.4],
 ['2023-12-21', 9.14, 9.18, 9.07, 9.26],
 ['2023-12-22', 9.2, 9.12, 9.08, 9.24],
 ['2023-12-25', 9.14, 9.12, 9.1, 9.2],
 ['2023-12-26', 9.13, 8.96, 8.95, 9.15],
 ['2023-12-27', 9.03, 9.01, 8.94, 9.11],
 ['2023-12-28', 9.0, 9.24, 8.91, 9.29],
 ['2023-12-29', 9.2, 9.38, 9.17, 9.43],
 ['2024-01-02', 9.39, 9.29, 9.22, 9.4],
 ['2024-01-03', 9.29, 9.34, 9.23, 9.41],
 ['2024-01-04', 9.32, 9.39, 9.3, 9.48],
 ['2024-01-05', 9.33, 9.17, 9.12, 9.57],
 ['2024-01-08', 9.18, 9.02, 9.01, 9.21],
 ['2024-01-09', 9.04, 9.02, 8.97, 9.16],
 ['2024-01-10', 9.0, 8.9, 8.79, 9.05],
 ['2024-01-11', 8.89, 9.27, 8.86, 9.33],
 ['2024-01-12', 9.25, 9.29, 9.19, 9.35],
 ['2024-01-15', 9.25, 9.26, 9.11, 9.32],
 ['2024-01-16', 9.22, 9.28, 9.16, 9.31],
 ['2024-01-17', 9.28, 9.09, 9.09, 9.28],
 ['2024-01-18', 9.06, 9.06, 8.81, 9.14],
 ['2024-01-19', 9.03, 8.9, 8.9, 9.1],
 ['2024-01-22', 8.9, 8.42, 8.4, 8.92],
 ['2024-01-23', 8.42, 8.6, 8.32, 8.72],
 ['2024-01-24', 8.64, 8.88, 8.52, 8.95],
 ['2024-01-25', 8.85, 9.31, 8.77, 9.39],
 ['2024-01-26', 9.23, 9.16, 9.11, 9.4],
 ['2024-01-29', 9.21, 9.26, 9.17, 9.53],
 ['2024-01-30', 9.13, 8.71, 8.69, 9.14],
 ['2024-01-31', 8.67, 8.52, 8.45, 8.85],
 ['2024-02-01', 8.45, 8.55, 8.37, 8.8],
 ['2024-02-02', 8.55, 8.25, 8.01, 8.73],
 ['2024-02-05', 8.2, 7.97, 7.61, 8.37],
 ['2024-02-06', 7.96, 8.42, 7.78, 8.54],
 ['2024-02-07', 8.41, 8.74, 8.36, 8.86],
 ['2024-02-08', 8.8, 9.1, 8.8, 9.2],
 ['2024-02-19', 9.17, 9.05, 8.92, 9.25],
 ['2024-02-20', 8.95, 8.88, 8.68, 8.95],
 ['2024-02-21', 8.82, 9.2, 8.76, 9.35],
 ['2024-02-22', 9.16, 9.23, 9.1, 9.25],
 ['2024-02-23', 9.24, 9.32, 9.05, 9.33],
 ['2024-02-26', 9.45, 9.6, 9.44, 9.76],
 ['2024-02-27', 9.51, 9.8, 9.48, 9.85],
 ['2024-02-28', 9.7, 9.22, 9.22, 9.77],
 ['2024-02-29', 9.16, 9.6, 9.12, 9.6],
 ['2024-03-01', 9.6, 9.54, 9.44, 9.69],
 ['2024-03-04', 9.53, 9.45, 9.39, 9.58],
 ['2024-03-05', 9.4, 9.81, 9.29, 9.85],
 ['2024-03-06', 9.7, 9.65, 9.57, 9.78],
 ['2024-03-07', 9.6, 9.56, 9.56, 9.82],
 ['2024-03-08', 9.55, 9.6, 9.5, 9.63],
 ['2024-03-12', 10.12, 9.91, 9.87, 10.51],
 ['2024-03-13', 9.81, 9.84, 9.8, 10.15],
 ['2024-03-14', 9.79, 9.7, 9.63, 9.9],
 ['2024-03-15', 9.71, 9.9, 9.64, 9.93],
 ['2024-03-18', 9.95, 10.08, 9.95, 10.2],
 ['2024-03-19', 10.05, 9.9, 9.9, 10.08],
 ['2024-03-20', 9.89, 10.0, 9.88, 10.05],
 ['2024-03-21', 10.04, 10.1, 9.97, 10.13],
 ['2024-03-22', 9.91, 9.74, 9.68, 9.93],
 ['2024-03-25', 9.71, 9.48, 9.48, 9.77],
 ['2024-03-26', 9.5, 9.59, 9.43, 9.61]];

var data0 = splitData(mydata2);
function splitData(rawData) {
  const categoryData = [];
  const values = [];
  for (var i = 0; i < rawData.length; i++) {
    categoryData.push(rawData[i].splice(0, 1)[0]);
    values.push(rawData[i]);
  }
  return {
    categoryData: categoryData,
    values: values
  };
}
function calculateMA(dayCount) {
  var result = [];
  for (var i = 0, len = data0.values.length; i < len; i++) {
    if (i < dayCount) {
      result.push('-');
      continue;
    }
    var sum = 0;
    for (var j = 0; j < dayCount; j++) {
      sum += +data0.values[i - j][1];
    }
    result.push(sum / dayCount);
  }
  return result;
}
option = {
  title: {
    text: '中集车辆日K线图',
    left: 0
  },
  tooltip: {
    trigger: 'axis',
    axisPointer: {
      type: 'cross'
    }
  },
  legend: {
    data: ['日K', 'MA5', 'MA10', 'MA20', 'MA30']
  },
  grid: {
    left: '10%',
    right: '10%',
    bottom: '15%'
  },
  xAxis: {
    type: 'category',
    data: data0.categoryData,
    boundaryGap: false,
    axisLine: { onZero: false },
    splitLine: { show: false },
    min: 'dataMin',
    max: 'dataMax'
  },
  yAxis: {
    scale: true,
    splitArea: {
      show: true
    }
  },
  dataZoom: [
    {
      type: 'inside',
      start: 50,
      end: 100
    },
    {
      show: true,
      type: 'slider',
      top: '90%',
      start: 50,
      end: 100
    }
  ],
  series: [
    {
      name: '日K',
      type: 'candlestick',
      data: data0.values,
      itemStyle: {
        color: upColor,
        color0: downColor,
        borderColor: upBorderColor,
        borderColor0: downBorderColor
      },
      markPoint: {
        label: {
          formatter: function (param) {
            return param != null ? Math.round(param.value) + '' : '';
          }
        },
        data: [
          {
            name: 'Mark',
            coord: ['2013/5/31', 2300],
            value: 2300,
            itemStyle: {
              color: 'rgb(41,60,85)'
            }
          },
          {
            name: 'highest value',
            type: 'max',
            valueDim: 'highest'
          },
          {
            name: 'lowest value',
            type: 'min',
            valueDim: 'lowest'
          },
          {
            name: 'average value on close',
            type: 'average',
            valueDim: 'close'
          }
        ],
        tooltip: {
          formatter: function (param) {
            return param.name + '<br>' + (param.data.coord || '');
          }
        }
      },
      markLine: {
        symbol: ['none', 'none'],
        data: [
          [
            {
              name: 'from lowest to highest',
              type: 'min',
              valueDim: 'lowest',
              symbol: 'circle',
              symbolSize: 10,
              label: {
                show: false
              },
              emphasis: {
                label: {
                  show: false
                }
              }
            },
            {
              type: 'max',
              valueDim: 'highest',
              symbol: 'circle',
              symbolSize: 10,
              label: {
                show: false
              },
              emphasis: {
                label: {
                  show: false
                }
              }
            }
          ],
          {
            name: 'min line on close',
            type: 'min',
            valueDim: 'close'
          },
          {
            name: 'max line on close',
            type: 'max',
            valueDim: 'close'
          }
        ]
      }
    },
    {
      name: 'MA5',
      type: 'line',
      data: calculateMA(5),
      smooth: true,
      lineStyle: {
        opacity: 0.5
      }
    },
    {
      name: 'MA10',
      type: 'line',
      data: calculateMA(10),
      smooth: true,
      lineStyle: {
        opacity: 0.5
      }
    },
    {
      name: 'MA20',
      type: 'line',
      data: calculateMA(20),
      smooth: true,
      lineStyle: {
        opacity: 0.5
      }
    },
    {
      name: 'MA30',
      type: 'line',
      data: calculateMA(30),
      smooth: true,
      lineStyle: {
        opacity: 0.5
      }
    }
  ]
};

option && myChart.setOption(option);
